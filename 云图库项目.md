## day1  å‰ç«¯é¡¹ç›®åˆå§‹åŒ–

### åˆ›å»ºé¡¹ç›®

åœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤ï¼š

```sql
npm create vue@latest
```

![](https://pic.code-nav.cn/course_picture/1612112932991139842/iVb3qq4uRl03jEH5.webp)

 æ‰“å¼€é¡¹ç›®ï¼Œå…ˆåœ¨ç»ˆç«¯æ‰§è¡Œ `npm install` å®‰è£…ä¾èµ–ï¼Œç„¶åæ‰§è¡Œ `npm run dev` èƒ½è®¿é—®ç½‘é¡µå°±æˆåŠŸäº†ã€‚


### å‰ç«¯å·¥ç¨‹åŒ–é…ç½®

è„šæ‰‹æ¶å·²ç»å¸®æˆ‘ä»¬æ•´åˆäº† Prettier ä»£ç ç¾åŒ–ã€ESLint è‡ªåŠ¨æ ¡éªŒã€TypeScript ç±»å‹æ ¡éªŒï¼Œæ— éœ€å†è‡ªè¡Œæ•´åˆã€‚


### å¼•å…¥ç»„ä»¶åº“

å¼•å…¥ Ant Design Vue ç»„ä»¶åº“ï¼Œå‚è€ƒ [å®˜æ–¹æ–‡æ¡£](https://antdv.com/docs/vue/getting-started-cn) å¿«é€Ÿä¸Šæ‰‹ã€‚
æ‰§è¡Œå®‰è£…ï¼š

```css
npm i --save ant-design-vue@4.x
```

æ”¹å˜ä¸»å…¥å£æ–‡ä»¶ main.tsï¼Œå…¨å±€æ³¨å†Œç»„ä»¶ï¼ˆä¸ºäº†æ–¹ä¾¿ï¼‰ï¼š

```javascript
import App from './App.vue'
import router from './router'
import Antd from "ant-design-vue";
import "ant-design-vue/dist/reset.css";

const app = createApp(App)
app.use(Antd);
app.use(createPinia())
app.use(router)

app.mount('#app')
```



### å¼€å‘è§„èŒƒ

å»ºè®®éµå¾ª Vue3 çš„ç»„åˆå¼ API (Composition API)ï¼Œè€Œä¸æ˜¯ [é€‰é¡¹å¼ API](https://cn.vuejs.org/guide/introduction.html#composition-api)ï¼Œå¼€å‘æ›´è‡ªç”±é«˜æ•ˆä¸€äº›ã€‚9JcB9KvGktsJeCekY//R96Nlv+uCpT8TeUU7sYgObzE=

ç¤ºä¾‹ä»£ç ï¼š

```php-template
<template>
  <div id="xxPage">

  </div>
</template>

<script setup lang="ts">

</script>

<style scoped>
#xxPage {
}

</style>
```

### é¡µé¢åŸºæœ¬ä¿¡æ¯

å¯ä»¥ä¿®æ”¹é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `index.html` æ–‡ä»¶ï¼Œæ¥å®šä¹‰é¡µé¢çš„å…ƒä¿¡æ¯ï¼Œæ¯”å¦‚ä¿®æ”¹æ ‡é¢˜ï¼š

```php-template
<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é±¼çš®äº‘å›¾åº“</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
```

è¿˜å¯ä»¥æ›¿æ¢ public ç›®å½•ä¸‹é»˜è®¤çš„ ico å›¾æ ‡ä¸ºè‡ªå·±çš„ï¼Œæœ‰å¾ˆå¤š [ç°æˆçš„ç½‘ç«™](https://www.bitbug.net/) å¯ä»¥åˆ¶ä½œ ico å›¾æ ‡ã€‚uPqbd3DiPd3iSPyF1TJ20nEUpYukqZektmm49mRYrTY=

æ•ˆæœå¦‚å›¾ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/bk8gPn0yFsZU4Bkc.png)

### å…¨å±€é€šç”¨å¸ƒå±€

#### 1ã€åŸºç¡€å¸ƒå±€ç»“æ„

åœ¨ layouts ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªå¸ƒå±€ `BasicLayout.vue`ï¼Œ åœ¨ App.vue å…¨å±€é¡µé¢å…¥å£æ–‡ä»¶ä¸­å¼•å…¥ã€‚

App.vue ä»£ç å¦‚ä¸‹ï¼šB2z6448PQSc3P5d8RibCpEJZ9ZaX16ayHXniF5A52nY=

```php-template
<template>
  <div id="app">
    <BasicLayout />
  </div>
</template>

<script setup lang="ts">
import BasicLayout from "@/layouts/BasicLayout.vue";
</script>
```

å¯ä»¥ç§»é™¤é¡µé¢å†…çš„é»˜è®¤æ ·å¼ã€å¹¶ä¸”ç§»é™¤ main.ts ä¸­é»˜è®¤å¼•å…¥çš„ main.cssï¼Œé˜²æ­¢æ ·å¼æ±¡æŸ“ï¼š

```php-template
<style>
#app {
}
</style>
```

é€‰ç”¨ Ant Design ç»„ä»¶åº“çš„ [Layout ç»„ä»¶](https://antdv.com/components/layout-cn) ï¼Œå…ˆæŠŠã€ä¸Šä¸­ä¸‹ã€‘å¸ƒå±€ç¼–æ’å¥½ï¼Œç„¶åå†å¡«å……å†…å®¹ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/kJS5TSGYKESmhJFM.webp)

ä»£ç å¦‚ä¸‹ï¼šTJqV4WBBT2IFrp0o3vsnkggN7VzNkVQlxvcX5lXRIJI=

```php-template
<template>
  <div id="basicLayout">
    <a-layout style="min-height: 100vh">
      <a-layout-header>Header</a-layout-header>
      <a-layout-content>Content</a-layout-content>
      <a-layout-footer>Footer</a-layout-footer>
    </a-layout>
  </div>
</template>

<script setup lang="ts"></script>
```

æ ·å¼ï¼š

```php-template
<style scoped>
#basicLayout {
}
</style>
```

#### 2ã€å…¨å±€åº•éƒ¨æ 

é€šå¸¸ç”¨äºå±•ç¤ºç‰ˆæƒä¿¡æ¯ï¼š

```php-template
<a-layout-footer class="footer">
  <a href="https://www.codefather.cn" target="_blank">
    ç¼–ç¨‹å¯¼èˆª by ç¨‹åºå‘˜é±¼çš®
  </a>
</a-layout-footer>
```

æ ·å¼ï¼š

```css
#basicLayout .footer {
  background: #efefef;
  padding: 16px;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  text-align: center;
}
```

#### 3ã€åŠ¨æ€æ›¿æ¢å†…å®¹

é¡¹ç›®ä½¿ç”¨äº† [Vue Router](https://router.vuejs.org/zh/introduction.html) è·¯ç”±åº“ï¼Œå¯ä»¥åœ¨ `router/index.ts` é…ç½®è·¯ç”±ï¼Œèƒ½å¤Ÿæ ¹æ®è®¿é—®çš„é¡µé¢åœ°å€æ‰¾åˆ°ä¸åŒçš„æ–‡ä»¶å¹¶åŠ è½½æ¸²æŸ“ã€‚

ä¿®æ”¹ BasicLayout å†…å®¹éƒ¨åˆ†çš„ä»£ç å¦‚ä¸‹ï¼šâ€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‰â€‰â€‰â€‰â€‰â€‚â€‚â€‚â€‰â€‚â€‚â€‰â€‚â€‚â€‚â€‚

```php-template
<a-layout-content class="content">
  <router-view />
</a-layout-content>
```

ä¿®æ”¹æ ·å¼ï¼Œè¦å’Œåº•éƒ¨æ ä¿æŒä¸€å®šçš„å¤–è¾¹è·ï¼Œå¦åˆ™å†…å®¹ä¼šè¢«é®ä½ï¼š

```php-template
<style scoped>
#basicLayout .content {
  background: linear-gradient(to right, #fefefe, #fff);
  margin-bottom: 28px;
  padding: 20px;
}
</style>
```

#### 4ã€å…¨å±€é¡¶éƒ¨æ 

ç”±äºé¡¶éƒ¨æ çš„å¼€å‘ç›¸å¯¹å¤æ‚ï¼Œå¯ä»¥åŸºäº [Ant Design çš„èœå•ç»„ä»¶](https://antdv.com/components/menu-cn) æ¥åˆ›å»º `GlobalHeader` å…¨å±€é¡¶éƒ¨æ ç»„ä»¶ï¼Œ\*\*ç»„ä»¶ç»Ÿä¸€æ”¾åœ¨ components ç›®å½•ä¸­ \*\*ã€‚

å…ˆç›´æ¥å¤åˆ¶ç°æˆçš„ç»„ä»¶ç¤ºä¾‹ä»£ç åˆ° GlobalHeader ä¸­å³å¯ã€‚

![](https://pic.code-nav.cn/course_picture/1612112932991139842/4wA4zaDAL98eCerU.webp)

åœ¨åŸºç¡€å¸ƒå±€ä¸­å¼•å…¥é¡¶éƒ¨æ ç»„ä»¶ï¼š

```php-template
<a-layout-header class="header">
  <GlobalHeader />
</a-layout-header>
```

å¼•å…¥ä»£ç å¦‚ä¸‹ï¼šiIeB8mD2J1oXqiOtY3taWTPWsqKxcGCkYX8MdOVhu+A=

```php-template
<script setup lang="ts">
import GlobalHeader from "@/components/GlobalHeader.vue";
</script>
```

æ•ˆæœå¦‚ä¸‹ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/LTuD3h4i8J4wZ7EA.webp)

å¯ä»¥ä¿®æ”¹ä¸‹å…¨å±€ Header çš„æ ·å¼ï¼Œæ¸…é™¤ä¸€äº›é»˜è®¤æ ·å¼ï¼ˆæ¯”å¦‚èƒŒæ™¯è‰²ç­‰ï¼‰ï¼Œæ ·å¼ä»£ç å¦‚ä¸‹ï¼š

```css
#basicLayout .header {
  padding-inline: 20px;
  margin-bottom: 16px;
  color: unset;
  background: white;
}
```

æ¥ä¸‹æ¥è¦ä¿®æ”¹ GlobalHeader ç»„ä»¶ï¼Œå®Œå–„æ›´å¤šå†…å®¹ã€‚NYk9omRRbMtb6eYnCAArAErDvMuLhxdFfhahbRdMVZs=

1ï¼‰ç»™èœå•å¤–å¥—ä¸€å±‚å…ƒç´ ï¼Œç”¨äºæ•´ä½“æ§åˆ¶æ ·å¼ï¼š

```php-template
<div id="globalHeader">
  <a-menu v-model:selectedKeys="current" mode="horizontal" :items="items" />
</div>
```

2ï¼‰æ ¹æ®æˆ‘ä»¬çš„éœ€æ±‚ä¿®æ”¹èœå•é…ç½®ï¼Œkey ä¸ºè¦è·³è½¬çš„ URL è·¯å¾„ï¼šNYk9omRRbMtb6eYnCAArAErDvMuLhxdFfhahbRdMVZs=

```php-template
<script lang="ts" setup>
import { h, ref } from 'vue'
import { HomeOutlined } from '@ant-design/icons-vue'
import { MenuProps } from 'ant-design-vue'

const current = ref<string[]>(['home'])
const items = ref<MenuProps['items']>([
  {
    key: '/',
    icon: () => h(HomeOutlined),
    label: 'ä¸»é¡µ',
    title: 'ä¸»é¡µ',
  },
  {
    key: '/about',
    label: 'å…³äº',
    title: 'å…³äº',
  },
  {
    key: 'others',
    label: h('a', { href: 'https://www.codefather.cn', target: '_blank' }, 'ç¼–ç¨‹å¯¼èˆª'),
    title: 'ç¼–ç¨‹å¯¼èˆª',
  },
])
</script>
```

æ•ˆæœå¦‚å›¾ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/3ktqpmgIKLzV4cBj.webp)

3ï¼‰å®Œå–„å…¨å±€é¡¶éƒ¨æ ï¼Œå·¦ä¾§è¡¥å……ç½‘ç«™å›¾æ ‡å’Œæ ‡é¢˜ã€‚

å…ˆæŠŠ logo.png æ”¾åˆ° src/assets ç›®å½•ä¸‹ï¼Œæ›¿æ¢æ‰åŸæœ¬çš„é»˜è®¤ Logoï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/7NpC45MKgn29z1jg.png)

ä¿®æ”¹ GlobalHeader ä»£ç ï¼Œè¡¥å…… HTMLï¼š

```php-template
<RouterLink to="/">
  <div class="title-bar">
    <img class="logo" src="../assets/logo.png" alt="logo" />
    <div class="title">é±¼çš®äº‘å›¾åº“</div>
  </div>
</RouterLink>
```

å…¶ä¸­ï¼ŒRouterLink ç»„ä»¶çš„ä½œç”¨æ˜¯æ”¯æŒè¶…é“¾æ¥è·³è½¬ï¼ˆä¸åˆ·æ–°é¡µé¢ï¼‰ã€‚xo0dnOlnBf7Ws27/qGm2TPReUJyIxD/DuwJOjlvKUe0=

è¡¥å…… CSS æ ·å¼ï¼š

```php-template
<style scoped>
.title-bar {
  display: flex;
  align-items: center;
}

.title {
  color: black;
  font-size: 18px;
  margin-left: 16px;
}

.logo {
  height: 48px;
}
</style>
```

4ï¼‰å®Œå–„é¡¶éƒ¨å¯¼èˆªæ ï¼Œå³ä¾§å±•ç¤ºå½“å‰ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼ˆæš‚æ—¶ç”¨ç™»å½•æŒ‰é’®ä»£æ›¿ï¼‰ï¼šE2AG5YeWw8LgKsKYXs9Vrz+8AgTqaJUf5eaOZTC+BFg=

```php-template
<div class="user-login-status">
  <a-button type="primary" href="/user/login">ç™»å½•</a-button>
</div>
```

5ï¼‰ä¼˜åŒ–å¯¼èˆªæ çš„å¸ƒå±€ï¼Œé‡‡ç”¨ [æ …æ ¼ç»„ä»¶çš„è‡ªé€‚åº”å¸ƒå±€](https://antdv.com/components/grid-cn#components-grid-demo-flex-stretch)ï¼ˆå·¦ä¸­å³ç»“æ„ï¼Œå·¦ä¾§å³ä¾§å®½åº¦å›ºå®šï¼Œä¸­é—´èœå•æ è‡ªé€‚åº”ï¼‰
æ­¤å¤„:wrap="false"å¿…é¡»è¦:  å¦åˆ™vueä¼šå°†falseè§£ææˆå­—ç¬¦ä¸²ï¼Œå¯¹åº”çš„å¸ƒå°”å€¼æ˜¯true
```php-template
<a-row :wrap="false">
  <a-col flex="200px">
    <RouterLink to="/">
      <div class="title-bar">
        <img class="logo" src="../assets/logo.png" alt="logo" />
        <div class="title">é±¼çš®äº‘å›¾åº“</div>
      </div>
    </RouterLink>
  </a-col>
  <a-col flex="auto">
    <a-menu
      v-model:selectedKeys="current"
      mode="horizontal"
      :items="items"
    />
  </a-col>
  <a-col flex="120px">
    <div class="user-login-status">
      <a-button type="primary" href="/user/login">ç™»å½•</a-button>
    </div>
  </a-col>
</a-row>
```

æ•ˆæœå¦‚å›¾ï¼Œå¯ä»¥å°è¯•ç¼©å°æµè§ˆå™¨çª—å£è§‚å¯Ÿå¯¼èˆªæ¡çš„å˜åŒ–ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/E8gMQlaF0AtwQ9Yi.webp)

### è·¯ç”±

ç›®æ ‡ï¼šç‚¹å‡»èœå•é¡¹åï¼Œå¯ä»¥è·³è½¬åˆ°å¯¹åº”çš„é¡µé¢ï¼›å¹¶ä¸”åˆ·æ–°é¡µé¢åï¼Œå¯¹åº”çš„èœå•è‡ªåŠ¨é«˜äº®ã€‚

#### 1ã€ä¿®æ”¹è·¯ç”±é…ç½®

æŒ‰éœ€ä¿®æ”¹ router/index.ts æ–‡ä»¶çš„ routes é…ç½®ï¼Œå®šä¹‰æˆ‘ä»¬éœ€è¦çš„é¡µé¢è·¯ç”±ï¼Œæ¯ä¸ª path å¯¹åº”ä¸€ä¸ª componentï¼ˆè¦åŠ è½½çš„ç»„ä»¶ï¼‰ï¼šE2AG5YeWw8LgKsKYXs9Vrz+8AgTqaJUf5eaOZTC+BFg=

```javascript
routes: [
  {
    path: '/',
    name: 'home',
    component: HomeView,
  },
  {
    path: '/about',
    name: 'about',
    // route level code-splitting
    // this generates a separate chunk (About.[hash].js) for this route
    // which is lazy-loaded when the route is visited.
    component: () => import('../views/AboutView.vue'),
  },
],
```

è§‚å¯Ÿä¸Šè¿°ä»£ç ï¼Œä¼šå‘ç° component æ”¯æŒç›´æ¥ä¼ å…¥ç»„ä»¶ã€æˆ–è€…ä½¿ç”¨ import æŒ‰éœ€æ‡’åŠ è½½ç»„ä»¶ï¼ŒæŒ‰éœ€åŠ è½½æ˜¯ä¸€ç§ä¼˜åŒ–é¦–æ¬¡æ‰“å¼€ç«™ç‚¹æ€§èƒ½çš„æ–¹å¼ã€‚

#### 2ã€è·¯ç”±è·³è½¬

ç»™ GlobalHeader çš„èœå•ç»„ä»¶ç»‘å®šè·³è½¬äº‹ä»¶ï¼š

```typescript
import { useRouter } from "vue-router";
const router = useRouter();

// è·¯ç”±è·³è½¬äº‹ä»¶
const doMenuClick = ({ key }: { key: string }) => {
  router.push({
    path: key,
  });
};
```

ä¿®æ”¹ HTML æ¨¡æ¿ï¼Œç»‘å®šäº‹ä»¶ï¼šsV0XXF40kQah+NcVxFP1y4nQNGtV/XyQvOt/FJKWUoA=

```css
<a-menu
  v-model:selectedKeys="current"
  mode="horizontal"
  :items="items"
  @click="doMenuClick"
/>
```

#### 3ã€é«˜äº®åŒæ­¥

åˆ·æ–°é¡µé¢åï¼Œä½ ä¼šå‘ç°å½“å‰èœå•é¡¹å¹¶æ²¡æœ‰é«˜äº®ï¼Œæ‰€ä»¥éœ€è¦åŒæ­¥è·¯ç”±çš„æ›´æ–°åˆ°èœå•é¡¹é«˜äº®ã€‚sV0XXF40kQah+NcVxFP1y4nQNGtV/XyQvOt/FJKWUoA=

åŒæ­¥é«˜äº®åŸç†ï¼š

1.  ç‚¹å‡»èœå•æ—¶ï¼ŒAnt Design ç»„ä»¶å·²ç»é€šè¿‡ v-model ç»‘å®š current å˜é‡å®ç°äº†é«˜äº®ã€‚
2.  åˆ·æ–°é¡µé¢æ—¶ï¼Œéœ€è¦è·å–åˆ°å½“å‰ URL è·¯å¾„ï¼Œç„¶åä¿®æ”¹ current å˜é‡çš„å€¼ï¼Œä»è€Œå®ç°åŒæ­¥ã€‚

ä½¿ç”¨ Vue Router çš„ afterEach è·¯ç”±é’©å­å®ç°ï¼Œæ¯æ¬¡æ”¹å˜è·¯ç”±æˆ–åˆ·æ–°é¡µé¢æ—¶éƒ½ä¼šè‡ªåŠ¨æ›´æ–° current çš„å€¼ï¼Œä»è€Œå®ç°é«˜äº®ï¼šE2AG5YeWw8LgKsKYXs9Vrz+8AgTqaJUf5eaOZTC+BFg=

```typescript
const router = useRouter();
// å½“å‰é€‰ä¸­èœå•
const current = ref<string[]>([]);
// ç›‘å¬è·¯ç”±å˜åŒ–ï¼Œæ›´æ–°å½“å‰é€‰ä¸­èœå•
router.afterEach((to, from, next) => {
  current.value = [to.path];
});
```

ğŸ’¡æ€è€ƒï¼šå¤§å®¶æœ‰æ²¡æœ‰å‘ç°ï¼Œè·¯ç”±å’Œèœå•é…ç½®ä¸­ï¼Œæœ‰ä¸€äº›æ˜¯é‡å¤çš„å‘¢ï¼Ÿæœ‰æ²¡æœ‰æ›´å¥½åœ°æ–¹å¼æ¥é…ç½®è·¯ç”±å’Œèœå•é¡¹ï¼Œä¸ç”¨æ¯æ¬¡ä¿®æ”¹æ—¶éƒ½è¦æ”¹ä¸¤è¾¹çš„ä»£ç å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯å°†è·¯ç”±é…ç½®æ•°ç»„ä¼ é€’ç»™èœå•ç»„ä»¶ï¼Œå¤§å®¶å¯ä»¥å°è¯•è‡ªè¡Œå®ç°ã€‚ï¼ˆé±¼çš®çš„ [OJ åˆ¤é¢˜ç³»ç»Ÿé¡¹ç›®](https://www.codefather.cn/course)ã€[é±¼ç­”ç­” AI ç­”é¢˜åº”ç”¨å¹³å°é¡¹ç›®](https://www.codefather.cn/course) ä¸­æœ‰è®²è¿‡ï¼‰

### è¯·æ±‚

> å¼•å…¥ Axios è¯·æ±‚åº“

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå‰ç«¯åªè´Ÿè´£ç•Œé¢å±•ç¤ºå’ŒåŠ¨æ•ˆäº¤äº’ï¼Œå°½é‡é¿å…å†™å¤æ‚çš„é€»è¾‘ï¼›å½“éœ€è¦è·å–æ•°æ®æ—¶ï¼Œé€šå¸¸æ˜¯å‘åç«¯æä¾›çš„æ¥å£å‘é€è¯·æ±‚ï¼Œç”±åç«¯æ‰§è¡Œæ“ä½œï¼ˆæ¯”å¦‚ä¿å­˜æ•°æ®ï¼‰å¹¶å“åº”æ•°æ®ç»™å‰ç«¯ã€‚

å‰ç«¯å¦‚ä½•å‘åç«¯å‘é€è¯·æ±‚å‘¢ï¼Ÿæœ€ä¼ ç»Ÿçš„æ–¹å¼æ˜¯ä½¿ç”¨ AJAX æŠ€æœ¯ã€‚ä½†å…¶ä»£ç æœ‰äº›å¤æ‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„å°è£…åº“ï¼Œæ¥ç®€åŒ–å‘é€è¯·æ±‚çš„ä»£ç ï¼Œæ¯”å¦‚ä¸»æµçš„è¯·æ±‚å·¥å…·åº“ Axiosã€‚9JcB9KvGktsJeCekY//R96Nlv+uCpT8TeUU7sYgObzE=

#### 1ã€è¯·æ±‚å·¥å…·åº“

å®‰è£…è¯·æ±‚å·¥å…·ç±» Axiosï¼Œå‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š[https://axios-http.com/docs/intro](https://axios-http.com/docs/intro)

ä»£ç ï¼šB2z6448PQSc3P5d8RibCpEJZ9ZaX16ayHXniF5A52nY=

```
npm install axios
```

#### 2ã€å…¨å±€è‡ªå®šä¹‰è¯·æ±‚

éœ€è¦è‡ªå®šä¹‰å…¨å±€è¯·æ±‚åœ°å€ç­‰ï¼Œå‚è€ƒ Axios å®˜æ–¹æ–‡æ¡£ï¼Œç¼–å†™è¯·æ±‚é…ç½®æ–‡ä»¶ `request.ts`ã€‚åŒ…æ‹¬å…¨å±€æ¥å£è¯·æ±‚åœ°å€ã€è¶…æ—¶æ—¶é—´ã€è‡ªå®šä¹‰è¯·æ±‚å“åº”æ‹¦æˆªå™¨ç­‰ã€‚TJqV4WBBT2IFrp0o3vsnkggN7VzNkVQlxvcX5lXRIJI=

å“åº”æ‹¦æˆªå™¨çš„åº”ç”¨åœºæ™¯ï¼šæˆ‘ä»¬éœ€è¦å¯¹æ¥å£çš„ **é€šç”¨å“åº”** è¿›è¡Œç»Ÿä¸€å¤„ç†ï¼Œæ¯”å¦‚ä» response ä¸­å–å‡º dataï¼›æˆ–è€…æ ¹æ® code å»é›†ä¸­å¤„ç†é”™è¯¯ã€‚è¿™æ ·ä¸ç”¨åœ¨æ¯ä¸ªæ¥å£è¯·æ±‚ä¸­éƒ½å»å†™ç›¸åŒçš„é€»è¾‘ã€‚

æ¯”å¦‚å¯ä»¥åœ¨å…¨å±€å“åº”æ‹¦æˆªå™¨ä¸­ï¼Œè¯»å–å‡ºç»“æœä¸­çš„ dataï¼Œå¹¶æ ¡éªŒ code æ˜¯å¦åˆæ³•ï¼Œå¦‚æœæ˜¯æœªç™»å½•çŠ¶æ€ï¼Œåˆ™è‡ªåŠ¨ç™»å½•ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼Œå…¶ä¸­ `withCredentials: true` ä¸€å®šè¦å†™ï¼Œå¦åˆ™æ— æ³•åœ¨å‘è¯·æ±‚æ—¶æºå¸¦ Cookieï¼Œå°±æ— æ³•å®Œæˆç™»å½•ã€‚xo0dnOlnBf7Ws27/qGm2TPReUJyIxD/DuwJOjlvKUe0=

ä»£ç å¦‚ä¸‹ï¼š

```javascript
import axios from 'axios'
import { message } from 'ant-design-vue'

// åˆ›å»º Axios å®ä¾‹
const myAxios = axios.create({
  baseURL: 'http://localhost:8123',
  timeout: 60000,
  withCredentials: true,
})

// å…¨å±€è¯·æ±‚æ‹¦æˆªå™¨
myAxios.interceptors.request.use(
  function (config) {
    // Do something before request is sent
    return config
  },
  function (error) {
    // Do something with request error
    return Promise.reject(error)
  },
)

// å…¨å±€å“åº”æ‹¦æˆªå™¨
myAxios.interceptors.response.use(
  function (response) {
    const { data } = response
    // æœªç™»å½•
    if (data.code === 40100) {
      // ä¸æ˜¯è·å–ç”¨æˆ·ä¿¡æ¯çš„è¯·æ±‚ï¼Œå¹¶ä¸”ç”¨æˆ·ç›®å‰ä¸æ˜¯å·²ç»åœ¨ç”¨æˆ·ç™»å½•é¡µé¢ï¼Œåˆ™è·³è½¬åˆ°ç™»å½•é¡µé¢
      if (
        !response.request.responseURL.includes('user/get/login') &&
        !window.location.pathname.includes('/user/login')
      ) {
        message.warning('è¯·å…ˆç™»å½•')
        window.location.href = `/user/login?redirect=${window.location.href}`
      }
    }
    return response
  },
  function (error) {
    // Any status codes that falls outside the range of 2xx cause this function to trigger
    // Do something with response error
    return Promise.reject(error)
  },
)

export default myAxios
```

#### 3ã€è‡ªåŠ¨ç”Ÿæˆè¯·æ±‚ä»£ç 

å¦‚æœé‡‡ç”¨ä¼ ç»Ÿå¼€å‘æ–¹å¼ï¼Œé’ˆå¯¹æ¯ä¸ªè¯·æ±‚éƒ½è¦å•ç‹¬ç¼–å†™ä»£ç ï¼Œå¾ˆéº»çƒ¦ã€‚

æ¨èä½¿ç”¨ OpenAPI å·¥å…·ï¼Œç›´æ¥è‡ªåŠ¨ç”Ÿæˆå³å¯ï¼š[https://www.npmjs.com/package/@umijs/openapi](https://www.npmjs.com/package/@umijs/openapi)

æŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„æ­¥éª¤ï¼Œå…ˆå®‰è£…ï¼šâ€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‰â€‰â€‰â€‰â€‰â€‚â€‚â€‚â€‰â€‚â€‚â€‰â€‚â€‚â€‚â€‚xo0dnOlnBf7Ws27/qGm2TPReUJyIxD/DuwJOjlvKUe0=

```css
npm i --save-dev @umijs/openapi
```

åœ¨ \*\*é¡¹ç›®æ ¹ç›®å½• \*\*æ–°å»º `openapi.config.js`ï¼Œæ ¹æ®è‡ªå·±çš„éœ€è¦å®šåˆ¶ç”Ÿæˆçš„ä»£ç ï¼š

```php
import { generateService } from '@umijs/openapi'

generateService({
  requestLibPath: "import request from '@/request'",
  schemaPath: 'http://localhost:8123/api/v2/api-docs',
  serversPath: './src',
})
```

**æ³¨æ„ï¼Œè¦å°† schemaPath æ”¹ä¸ºè‡ªå·±åç«¯æœåŠ¡æä¾›çš„ Swagger æ¥å£æ–‡æ¡£çš„åœ°å€ã€‚**

åœ¨ package.json çš„ script ä¸­æ·»åŠ  `"openapi": "node openapi.config.js"`

æ‰§è¡Œå³å¯ç”Ÿæˆè¯·æ±‚ä»£ç ï¼Œè¿˜åŒ…æ‹¬ TypeScript ç±»å‹ï¼šxo0dnOlnBf7Ws27/qGm2TPReUJyIxD/DuwJOjlvKUe0=

![](https://pic.code-nav.cn/course_picture/1612112932991139842/rjPby2IANNsRZEEx.webp)

ä»¥åæ¯æ¬¡åç«¯æ¥å£å˜æ›´æ—¶ï¼Œåªéœ€è¦é‡æ–°ç”Ÿæˆä¸€éå°±å¥½ï¼Œéå¸¸æ–¹ä¾¿~

#### 4ã€æµ‹è¯•è¯·æ±‚

å¯ä»¥å°è¯•åœ¨ä»»æ„é¡µé¢ä»£ç ä¸­è°ƒç”¨ APIï¼š

```javascript
import { healthUsingGet } from '@/api/mainController'

healthUsingGet().then((res) => {
  console.log(res)
})
```

æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯·æ±‚ï¼Œç”±äºæˆ‘ä»¬åç«¯å·²ç»æ·»åŠ äº†å…¨å±€è·¨åŸŸé…ç½®ï¼Œæ­£å¸¸æƒ…å†µä¸‹åº”è¯¥èƒ½çœ‹åˆ°å¦‚ä¸‹å“åº”ï¼šB2z6448PQSc3P5d8RibCpEJZ9ZaX16ayHXniF5A52nY=

![](https://pic.code-nav.cn/course_picture/1612112932991139842/Bqn7baGH3Qjeoxqx.webp)

#### 5ã€è§£å†³è·¨åŸŸï¼ˆå¯é€‰ï¼‰

å¦‚æœå‘ç°è¯·æ±‚é”™è¯¯ï¼Œè¦æŸ¥çœ‹é”™è¯¯ä¿¡æ¯å…·ä½“åˆ†æã€‚æ¯”å¦‚é‡åˆ° **è·¨åŸŸé—®é¢˜**ï¼Œè¿™æ˜¯ç”±äºå‰ç«¯ç½‘é¡µåœ°å€å’Œåç«¯è¯·æ±‚æ¥å£åœ°å€ä¸åŒå¯¼è‡´çš„ï¼š9JcB9KvGktsJeCekY//R96Nlv+uCpT8TeUU7sYgObzE=

![](https://pic.code-nav.cn/course_picture/1612112932991139842/bDwJvewtotrHjVOJ.webp)

è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹åç«¯ä»£ç ï¼Œå¢åŠ å…¨å±€è·¨åŸŸé…ç½®æˆ–è€…è·¨åŸŸæ³¨è§£æ¥è§£å†³ï¼š

![è·¨åŸŸæ³¨è§£](https://pic.code-nav.cn/course_picture/1612112932991139842/KO0O6l3lmodj4g1U.webp)

å¦‚æœåç«¯ä»£ç æ— æ³•ä¿®æ”¹ï¼Œè¿˜å¯ä»¥é€šè¿‡å‰ç«¯ä»£ç†æœåŠ¡å™¨æ¥è§£å†³ï¼Œå¦‚æœé¡¹ç›®ä½¿ç”¨ Viteï¼Œå†…ç½®äº†ä»£ç†æœåŠ¡å™¨ã€‚å¯ä»¥ä¿®æ”¹ vite.config.ts æ–‡ä»¶ï¼Œå¢åŠ ä»£ç†é…ç½®ï¼š

```php
export default defineConfig({
  server: {
    proxy: {
      '/api': 'http://localhost:8123',
    }
  },
})
```

åŒæ—¶ä¿®æ”¹ request.tsï¼Œç§»é™¤è¯·æ±‚å‰ç¼€ï¼šChdipREN0jrjiXgJ/YkPo5ufCLwmKJhcbf8H+qMVE48=

```php
// åˆ›å»º Axios å®ä¾‹
const myAxios = axios.create({
  baseURL: '',
  timeout: 60000,
  withCredentials: true,
})
```

è¿™æ ·ä¸€æ¥ï¼Œå‰ç«¯å‘é€çš„è¯·æ±‚åŸŸåå°±ç­‰åŒäºå½“å‰ URL çš„åŸŸåï¼Œå°±ä¸ä¼šå‡ºç°è·¨åŸŸã€‚ä½†æ˜¯è®¿é—®åˆ° /api å¼€å¤´çš„æ¥å£æ—¶ï¼Œä¼šè¢«ä»£ç†åˆ°è¯·æ±‚ 8123 ç«¯å£çš„åç«¯æœåŠ¡å™¨ï¼Œä»è€Œå®Œæˆè¯·æ±‚ã€‚

ğŸ’¡ è¿˜æœ‰å¾ˆå¤šå‰ç«¯ä»£ç†å·¥å…·ï¼Œæ¯”å¦‚ [Whistle](https://wproxy.org/whistle/install.html)ï¼Œå‰ç«¯æ–¹å‘çš„åŒå­¦å¯ä»¥å»äº†è§£ä¸‹ã€‚xo0dnOlnBf7Ws27/qGm2TPReUJyIxD/DuwJOjlvKUe0=

### å…¨å±€çŠ¶æ€ç®¡ç†

ä»€ä¹ˆæ˜¯å…¨å±€çŠ¶æ€ç®¡ç†ï¼Ÿ

ç­”ï¼šæ‰€æœ‰é¡µé¢å…¨å±€å…±äº«çš„å˜é‡ï¼Œè€Œä¸æ˜¯å±€é™åœ¨æŸä¸€ä¸ªé¡µé¢ä¸­ã€‚ChdipREN0jrjiXgJ/YkPo5ufCLwmKJhcbf8H+qMVE48=

é€‚åˆä½œä¸ºå…¨å±€çŠ¶æ€çš„æ•°æ®ï¼šå·²ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼ˆæ¯ä¸ªé¡µé¢å‡ ä¹éƒ½è¦ç”¨ï¼‰

Pinia æ˜¯ä¸€ä¸ªä¸»æµçš„çŠ¶æ€ç®¡ç†åº“ï¼Œç›¸æ¯”äº Vuex æ¥è¯´ä½¿ç”¨æ›´ç®€å•ï¼Œå¯å‚è€ƒ [å…¥é—¨æ–‡æ¡£](https://pinia.vuejs.org/zh/getting-started.html) è¿›è¡Œå¼•å…¥ã€‚

#### 1ã€å¼•å…¥ Pinia

æ­¤å¤„ç”±äº create-vue è„šæ‰‹æ¶å·²ç»å¸®æˆ‘ä»¬æ•´åˆäº† Piniaï¼Œæ— éœ€æ‰‹åŠ¨å¼•å…¥ï¼Œç›´æ¥ä½¿ç”¨å³å¯ã€‚

#### 2ã€å®šä¹‰çŠ¶æ€

åœ¨ src/stores ç›®å½•ä¸‹å®šä¹‰ user æ¨¡å—ï¼Œå®šä¹‰äº†ç”¨æˆ·çš„å­˜å‚¨ã€è¿œç¨‹è·å–ã€ä¿®æ”¹é€»è¾‘ï¼šB2z6448PQSc3P5d8RibCpEJZ9ZaX16ayHXniF5A52nY=

```javascript
import { defineStore } from "pinia";
import { ref } from "vue";

export const useLoginUserStore = defineStore("loginUser", () => {
  const loginUser = ref<any>({
    userName: "æœªç™»å½•",
  });

  async function fetchLoginUser() {
    // todo ç”±äºåç«¯è¿˜æ²¡æä¾›æ¥å£ï¼Œæš‚æ—¶æ³¨é‡Š
    // const res = await getCurrentUser();
    // if (res.data.code === 0 && res.data.data) {
    //   loginUser.value = res.data.data;
    // }
  }

  function setLoginUser(newLoginUser: any) {
    loginUser.value = newLoginUser;
  }

  return { loginUser, setLoginUser, fetchLoginUser };
});
```

#### 3ã€ä½¿ç”¨çŠ¶æ€

å¯ä»¥ç›´æ¥ä½¿ç”¨ store ä¸­å¯¼å‡ºçš„çŠ¶æ€å˜é‡å’Œå‡½æ•°ã€‚9JcB9KvGktsJeCekY//R96Nlv+uCpT8TeUU7sYgObzE=

åœ¨é¦–æ¬¡è¿›å…¥åˆ°é¡µé¢æ—¶ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šå°è¯•è·å–ç™»å½•ç”¨æˆ·ä¿¡æ¯ã€‚ä¿®æ”¹ App.vueï¼Œç¼–å†™è¿œç¨‹è·å–æ•°æ®ä»£ç ï¼š

```cpp
const loginUserStore = useLoginUserStore()
loginUserStore.fetchLoginUser()
```

åœ¨ä»»ä½•é¡µé¢ä¸­éƒ½å¯ä»¥ä½¿ç”¨æ•°æ®ï¼Œæ¯”å¦‚ GlobalHeader å…¨å±€é¡¶éƒ¨æ ç»„ä»¶ä¸­ç›´æ¥å±•ç¤ºï¼šNYk9omRRbMtb6eYnCAArAErDvMuLhxdFfhahbRdMVZs=

```javascript
{{ JSON.stringify(loginUserStore.loginUser) }}
```

ä¿®æ”¹å…¨å±€é¡¶éƒ¨æ ç»„ä»¶ï¼Œåœ¨å³ä¾§å±•ç¤ºç™»å½•çŠ¶æ€ï¼š

```php-template
<div class="user-login-status">
  <div v-if="loginUserStore.loginUser.id">
    {{ loginUserStore.loginUser.userName ?? 'æ— å' }}
  </div>
  <div v-else>
    <a-button type="primary" href="/user/login">ç™»å½•</a-button>
  </div>
</div>
```

#### 4ã€æµ‹è¯•å…¨å±€çŠ¶æ€ç®¡ç†

åœ¨ userStore ä¸­ç¼–å†™æµ‹è¯•ä»£ç ï¼Œæµ‹è¯•ç”¨æˆ·çŠ¶æ€çš„æ›´æ–°ï¼šâ€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‰â€‰â€‰â€‰â€‰â€‚â€‚â€‚â€‰â€‚â€‚â€‰â€‚â€‚â€‚â€‚

```javascript
async function fetchLoginUser() {
  // æµ‹è¯•ç”¨æˆ·ç™»å½•ï¼Œ3 ç§’åç™»å½•
  setTimeout(() => {
    loginUser.value = { userName: 'æµ‹è¯•ç”¨æˆ·', id: 1 }
  }, 3000)
}
```

æŸ¥çœ‹æ•ˆæœï¼Œç­‰å¾… 3 ç§’åç½‘ç«™å³ä¸Šæ–¹ä¼šå±•ç¤ºå‡ºç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/YTpW1ZzxrBuyTY2f.webp)

è‡³æ­¤ï¼Œä¸€ä¸ªå…¥é—¨çº§çš„å‰ç«¯é¡¹ç›®å°±åˆå§‹åŒ–å¥½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œé¡µé¢å¼€å‘ã€‚9JcB9KvGktsJeCekY//R96Nlv+uCpT8TeUU7sYgObzE=

### é¡µé¢å¼€å‘æµç¨‹

æˆ‘ä»¬é€šè¿‡å¼€å‘ä¸€ä¸ªç®€æ˜“çš„ç¤ºä¾‹é¡µé¢ï¼Œæ¥äº†è§£é¡µé¢å¼€å‘çš„æµç¨‹ã€‚

1ï¼‰æ–°å»º src/pages ç›®å½•ï¼Œç”¨äºå­˜æ”¾æ‰€æœ‰çš„é¡µé¢æ–‡ä»¶ã€‚xo0dnOlnBf7Ws27/qGm2TPReUJyIxD/DuwJOjlvKUe0=

ç„¶ååœ¨ pages ç›®å½•ä¸‹æ–°å»ºé¡µé¢æ–‡ä»¶ï¼Œå°†æ‰€æœ‰é¡µé¢æŒ‰ç…§ url å±‚çº§è¿›è¡Œåˆ›å»ºï¼Œå¹¶ä¸”é¡µé¢åç§°å°½é‡åšåˆ°â€œè§åçŸ¥æ„â€ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/d7kjkupXHeupqQa4.webp)

å…¶ä¸­ï¼Œ/user/login åœ°å€å°±å¯¹åº”äº† UserLoginPageã€‚

æ­¤å¤„æˆ‘ä»¬æ–°å»º HomePage.vue å³å¯ã€‚

2ï¼‰æ¯æ¬¡æ–°å»ºé¡µé¢æ—¶ï¼Œéœ€è¦åœ¨ router/index.ts ä¸­é…ç½®è·¯ç”±ï¼Œæ¯”å¦‚æ¬¢è¿é¡µçš„è·¯ç”±ä¸ºï¼šTJqV4WBBT2IFrp0o3vsnkggN7VzNkVQlxvcX5lXRIJI=

```css
const routes: Array<RouteRecordRaw> = [
  {
    path: "/",
    name: "home",
    component: HomeView,
  },
  ...
]
```

ç„¶ååœ¨è·¯ç”±æ–‡ä»¶ä¸­ï¼Œå¼•å…¥é¡µé¢ HomePageï¼š

```javascript
import HomePage from "@/pages/HomePage.vue";

const routes: Array<RouteRecordRaw> = [
  {
    path: "/",
    name: "home",
    component: HomePage,
  },
  ...
]
```

ä»»æ„ä¿®æ”¹é¡µé¢ä»£ç ï¼š

```php-template
<template>
  <div id="homePage">
    <h1>{{ msg }}</h1>
  </div>
</template>

<script setup lang="ts">
const msg = "æ¬¢è¿æ¥åˆ°ç¼–ç¨‹å¯¼èˆªï¼Œä½ å°†ä»è¿™é‡Œå¼€å§‹é¡¹ç›®å­¦ä¹ ä¹‹æ—…~";
</script>

<style scoped>
#homePage {
}
</style>
```

é¡µé¢æ•ˆæœå¦‚å›¾ï¼šsV0XXF40kQah+NcVxFP1y4nQNGtV/XyQvOt/FJKWUoA=

![](https://pic.code-nav.cn/course_picture/1612112932991139842/J6Aikr4YIjlz6dLK.webp)

### æ‰©å±•

åœ¨åç»­å¼€å‘ä¸­ä½ ä¼šå‘ç°ï¼ŒAnt Design Vue é»˜è®¤ä½¿ç”¨çš„æ˜¯è‹±æ–‡æ–‡æ¡ˆï¼Œå¦‚æœéœ€è¦æ›¿æ¢ä¸ºä¸­æ–‡ï¼Œå¯ä»¥å‚è€ƒ [å›½é™…åŒ–æ–‡æ¡£](https://antdv.com/docs/vue/i18n-cn)ï¼Œåªéœ€ç»™æ•´ä¸ªåº”ç”¨åŒ…è£¹ä¸€å±‚ç»„ä»¶å³å¯å®Œæˆã€‚NYk9omRRbMtb6eYnCAArAErDvMuLhxdFfhahbRdMVZs=

___
# day2 ç”¨æˆ·æ¨¡å—

### æ–°å»ºé¡µé¢å’Œè·¯ç”±

æŒ‰ç…§ä¸‹å›¾çš„ç»“æ„æ–°å»ºé¡µé¢æ–‡ä»¶ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/d7kjkupXHeupqQa4.webp)

ä¿®æ”¹ router/index.ts çš„è·¯ç”±é…ç½®ï¼šE2AG5YeWw8LgKsKYXs9Vrz+8AgTqaJUf5eaOZTC+BFg=

```css
routes: [
  {
    path: '/',
    name: 'ä¸»é¡µ',
    component: HomePage,
  },
  {
    path: '/user/login',
    name: 'ç”¨æˆ·ç™»å½•',
    component: UserLoginPage,
  },
  {
    path: '/user/register',
    name: 'ç”¨æˆ·æ³¨å†Œ',
    component: UserRegisterPage,
  },
  {
    path: '/admin/userManage',
    name: 'ç”¨æˆ·ç®¡ç†',
    component: UserManagePage,
  },
],
```

è®°å¾—æ‰§è¡Œä¸€ä¸‹ openapi å‘½ä»¤ç”Ÿæˆæ¥å£å¯¹åº”çš„è¯·æ±‚ä»£ç ï¼Œæ¯æ¬¡åç«¯æ”¹åŠ¨æ—¶éƒ½éœ€è¦è¿™ä¹ˆåšã€‚

### è·å–å½“å‰ç™»å½•ç”¨æˆ·

åœ¨ä¹‹å‰çš„æ•™ç¨‹ä¸­ï¼Œå·²ç»åˆ›å»ºäº†å‰ç«¯ç™»å½•ç”¨æˆ·çš„çŠ¶æ€ç®¡ç†æ–‡ä»¶ useLoginUserStore.tsã€‚ç°åœ¨åç«¯æä¾›äº†è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„æ¥å£ï¼Œç›´æ¥ä¿®æ”¹ fetchLoginUser å‡½æ•°å³å¯ï¼š

```kotlin
async function fetchLoginUser() {
  const res = await getLoginUserUsingGet()
  if (res.data.code === 0 && res.data.data) {
    loginUser.value = res.data.data
  }
}
```

å¯ä»¥é¡ºä¾¿ç»™ loginUser å¢åŠ  TypeScript ç±»å‹ï¼Œè¿™æ ·åœ¨åç»­å¼€å‘æ—¶å°±ä¼šæœ‰å­—æ®µæç¤ºï¼šChdipREN0jrjiXgJ/YkPo5ufCLwmKJhcbf8H+qMVE48=

```csharp
const loginUser = ref<API.LoginUserVO>({
  userName: 'æœªç™»å½•',
})
```

ä¹‹å‰åœ¨ GlobalHeader ä¸­å·²ç»ç¼–å†™å¥½æ˜¾ç¤ºå½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯çš„é¡µé¢ä»£ç ï¼š

```php-template
<div class="user-login-status">
  <div v-if="loginUserStore.loginUser.id">
    {{ loginUserStore.loginUser.userName ?? 'æ— å' }}
  </div>
  <div v-else>
    <a-button type="primary" href="/user/login">ç™»å½•</a-button>
  </div>
</div>
```

### ç”¨æˆ·ç™»å½•é¡µé¢

å¼€å‘ UserLoginPage.vueï¼Œå¯ä»¥åŸºäº [Ant Design çš„è¡¨å•ç»„ä»¶](https://antdv.com/components/form-cn) å¿«é€Ÿå¼€å‘ç™»å½•é¡µé¢ã€‚

å…ˆå¼€å‘åŸºç¡€é¡µé¢ï¼Œå¯ä»¥æŒ‰ç…§éœ€è¦å¢åŠ ä¸€äº›å‰ç«¯æ ¡éªŒï¼Œä»£ç å¦‚ä¸‹ï¼šE2AG5YeWw8LgKsKYXs9Vrz+8AgTqaJUf5eaOZTC+BFg=

```php-template
<template>
  <div id="userLoginPage">
    <h2 class="title">é±¼çš®äº‘å›¾åº“ - ç”¨æˆ·ç™»å½•</h2>
    <div class="desc">ä¼ä¸šçº§æ™ºèƒ½ååŒäº‘å›¾åº“</div>
    <a-form :model="formState" name="basic" autocomplete="off" @finish="handleSubmit">
      <a-form-item name="userAccount" :rules="[{ required: true, message: 'è¯·è¾“å…¥è´¦å·' }]">
        <a-input v-model:value="formState.userAccount" placeholder="è¯·è¾“å…¥è´¦å·" />
      </a-form-item>
      <a-form-item
        name="userPassword"
        :rules="[
          { required: true, message: 'è¯·è¾“å…¥å¯†ç ' },
          { min: 8, message: 'å¯†ç ä¸èƒ½å°äº 8 ä½' },
        ]"
      >
        <a-input-password v-model:value="formState.userPassword" placeholder="è¯·è¾“å…¥å¯†ç " />
      </a-form-item>
      <div class="tips">
        æ²¡æœ‰è´¦å·ï¼Ÿ
        <RouterLink to="/user/register">å»æ³¨å†Œ</RouterLink>
      </div>
      <a-form-item>
        <a-button type="primary" html-type="submit" style="width: 100%">ç™»å½•</a-button>
      </a-form-item>
    </a-form>
  </div>
</template>
```

å®šä¹‰ä¸€ä¸ªå“åº”å¼å˜é‡æ¥æ¥å—è¡¨å•è¾“å…¥çš„å€¼ï¼š

```csharp
const formState = reactive<API.UserLoginRequest>({
  userAccount: '',
  userPassword: '',
})
```

ç¼–å†™ CSS æ ·å¼ï¼Œç¾åŒ–é¡µé¢ï¼šâ€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‰â€‰â€‰â€‰â€‰â€‚â€‚â€‚â€‰â€‚â€‚â€‰â€‚â€‚â€‚â€‚

```css
#userLoginPage {
  max-width: 360px;
  margin: 0 auto;
}

.title {
  text-align: center;
  margin-bottom: 16px;
}

.desc {
  text-align: center;
  color: #bbb;
  margin-bottom: 16px;
}

.tips {
  margin-bottom: 16px;
  color: #bbb;
  font-size: 13px;
  text-align: right;
}
```

ç¼–å†™è¡¨å•æäº¤åæ‰§è¡Œçš„å‡½æ•°ï¼Œç™»é™†æˆåŠŸåéœ€è¦åœ¨å…¨å±€çŠ¶æ€ä¸­è®°å½•å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¹¶è·³è½¬åˆ°ä¸»é¡µï¼šTJqV4WBBT2IFrp0o3vsnkggN7VzNkVQlxvcX5lXRIJI=

```typescript
const router = useRouter()
const loginUserStore = useLoginUserStore()

/**
 * æäº¤è¡¨å•
 * @param values
 */
const handleSubmit = async (values: any) => {
  const res = await userLoginUsingPost(values)
  // ç™»å½•æˆåŠŸï¼ŒæŠŠç™»å½•æ€ä¿å­˜åˆ°å…¨å±€çŠ¶æ€ä¸­
  if (res.data.code === 0 && res.data.data) {
    await loginUserStore.fetchLoginUser()
    message.success('ç™»å½•æˆåŠŸ')
    router.push({
      path: '/',
      replace: true,
    })
  } else {
    message.error('ç™»å½•å¤±è´¥ï¼Œ' + res.data.message)
  }
}
```

é¡µé¢æ•ˆæœå¦‚å›¾ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/wDYKxTTxwHXj7E3f.webp)

### ç”¨æˆ·æ³¨å†Œé¡µé¢

åŒæ ·ä½¿ç”¨è¡¨å•ç»„ä»¶ï¼Œåœ¨ç”¨æˆ·ç™»å½•é¡µé¢çš„åŸºç¡€ä¸Šè°ƒæ•´å³å¯ï¼Œæ¶‰åŠåˆ°æ›´å¤šè¡¨å•é¡¹çš„å¡«å†™ï¼š

```php-template
<template>
  <div id="userRegisterPage">
    <h2 class="title">é±¼çš®äº‘å›¾åº“ - ç”¨æˆ·æ³¨å†Œ</h2>
    <div class="desc">ä¼ä¸šçº§æ™ºèƒ½ååŒäº‘å›¾åº“</div>
    <a-form
      :model="formState"
      name="basic"
      label-align="left"
      autocomplete="off"
      @finish="handleSubmit"
    >
      <a-form-item name="userAccount" :rules="[{ required: true, message: 'è¯·è¾“å…¥è´¦å·' }]">
        <a-input v-model:value="formState.userAccount" placeholder="è¯·è¾“å…¥è´¦å·" />
      </a-form-item>
      <a-form-item
        name="userPassword"
        :rules="[
          { required: true, message: 'è¯·è¾“å…¥å¯†ç ' },
          { min: 8, message: 'å¯†ç ä¸èƒ½å°äº 8 ä½' },
        ]"
      >
        <a-input-password v-model:value="formState.userPassword" placeholder="è¯·è¾“å…¥å¯†ç " />
      </a-form-item>
      <a-form-item
        name="checkPassword"
        :rules="[
          { required: true, message: 'è¯·è¾“å…¥ç¡®è®¤å¯†ç ' },
          { min: 8, message: 'ç¡®è®¤å¯†ç ä¸èƒ½å°äº 8 ä½' },
        ]"
      >
        <a-input-password v-model:value="formState.checkPassword" placeholder="è¯·è¾“å…¥ç¡®è®¤å¯†ç " />
      </a-form-item>
      <div class="tips">
        å·²æœ‰è´¦å·ï¼Ÿ
        <RouterLink to="/user/login">å»ç™»å½•</RouterLink>
      </div>
      <a-form-item>
        <a-button type="primary" html-type="submit" style="width: 100%">æ³¨å†Œ</a-button>
      </a-form-item>
    </a-form>
  </div>
</template>
```

å®šä¹‰è¡¨å•ä¿¡æ¯å˜é‡ï¼š

```csharp
const formState = reactive<API.UserRegisterRequest>({
  userAccount: '',
  userPassword: '',
  checkPassword: '',
})
```

ç¼–å†™æäº¤è¡¨å•å‡½æ•°ï¼Œå¯ä»¥å¢åŠ ä¸€äº›å‰ç«¯æ ¡éªŒï¼Œå¹¶ä¸”åœ¨æ³¨å†ŒæˆåŠŸåè·³è½¬åˆ°ç”¨æˆ·ç™»å½•é¡µï¼šTJqV4WBBT2IFrp0o3vsnkggN7VzNkVQlxvcX5lXRIJI=

```kotlin
const router = useRouter()

/**
 * æäº¤è¡¨å•
 * @param values
 */
const handleSubmit = async (values: any) => {
  // åˆ¤æ–­ä¸¤æ¬¡è¾“å…¥çš„å¯†ç æ˜¯å¦ä¸€è‡´
  if (formState.userPassword !== formState.checkPassword) {
    message.error('äºŒæ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´')
    return
  }
  const res = await userRegisterUsingPost(values)
  // æ³¨å†ŒæˆåŠŸï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢
  if (res.data.code === 0 && res.data.data) {
    message.success('æ³¨å†ŒæˆåŠŸ')
    router.push({
      path: '/user/login',
      replace: true,
    })
  } else {
    message.error('æ³¨å†Œå¤±è´¥ï¼Œ' + res.data.message)
  }
}
```

é¡µé¢æ•ˆæœå¦‚å›¾ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/uTQ3W8N8eLCze0G9.webp)

### ç”¨æˆ·æ³¨é”€

ä¸€èˆ¬é¼ æ ‡æ‚¬æµ®åœ¨å³ä¸Šè§’ç”¨æˆ·å¤´åƒæ—¶ï¼Œä¼šå±•ç¤ºåŒ…å«ç”¨æˆ·æ³¨é”€ï¼ˆé€€å‡ºç™»å½•ï¼‰åŠŸèƒ½çš„ä¸‹æ‹‰èœå•ã€‚

`<a-dropdown>`Â ç»„ä»¶æœ‰ä¸€ä¸ªä¸¥æ ¼çš„è§„åˆ™ï¼šå®ƒçš„è§¦å‘æ’æ§½ï¼ˆä¹Ÿå°±æ˜¯é»˜è®¤æ’æ§½ï¼‰é‡Œï¼Œå¿…é¡»åªæœ‰ä¸€ä¸ªæ ¹å…ƒç´ ã€‚æ‰€ä»¥å¿…é¡»ä½¿ç”¨`<a-space>`åŒ…è£¹å¤´åƒå’Œæ˜µç§°

å…ˆå¼€å‘é¡µé¢ç»“æ„ï¼š

```php-template
<div v-if="loginUserStore.loginUser.id">
  <a-dropdown>
    <ASpace>
      <a-avatar :src="loginUserStore.loginUser.userAvatar" />
      {{ loginUserStore.loginUser.userName ?? 'æ— å' }}
    </ASpace>
    <template #overlay>
      <a-menu>
        <a-menu-item @click="doLogout">
          <LogoutOutlined />
          é€€å‡ºç™»å½•
        </a-menu-item>
      </a-menu>
    </template>
  </a-dropdown>
</div>
```

ç¼–å†™ç”¨æˆ·æ³¨é”€äº‹ä»¶å‡½æ•°ï¼Œé€€å‡ºç™»å½•åè·³è½¬åˆ°ç™»å½•é¡µï¼š

```javascript
// ç”¨æˆ·æ³¨é”€
const doLogout = async () => {
  const res = await userLogoutUsingPost()
  console.log(res)
  if (res.data.code === 0) {
    loginUserStore.setLoginUser({
      userName: 'æœªç™»å½•',
    })
    message.success('é€€å‡ºç™»å½•æˆåŠŸ')
    await router.push('/user/login')
  } else {
    message.error('é€€å‡ºç™»å½•å¤±è´¥ï¼Œ' + res.data.message)
  }
}
```

æ•ˆæœå¦‚å›¾ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/Z9g6WnCBwRMOaHFU.webp)

### ç”¨æˆ·ç®¡ç†é¡µé¢

éœ€æ±‚ï¼šå…è®¸ç®¡ç†å‘˜æŸ¥çœ‹å·²æ³¨å†Œçš„ç”¨æˆ·ä¿¡æ¯ï¼Œèƒ½å¤Ÿæ ¹æ®ç”¨æˆ·åç§°æœç´¢ç”¨æˆ·ã€å¹¶åˆ é™¤éæ³•ç”¨æˆ·ã€‚

éœ€è¦æ³¨æ„ï¼Œè¦é˜²æ­¢æ™®é€šç”¨æˆ·ä¹Ÿèƒ½çœ‹åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œæ‰€ä»¥è¦å¢åŠ ä¸€å®šçš„æƒé™æ§åˆ¶ï¼Œå¯ä»¥åˆ†ä¸ºé¡µé¢å¼€å‘å’Œæƒé™æ§åˆ¶ä¸¤ä¸ªæ­¥éª¤æ¥å®ç°ã€‚

ç¼–å†™é¡µé¢ï¼šä¸Šæ–¹æœç´¢æ ï¼Œä¸‹æ–¹è¡¨æ ¼ï¼Œè¡¨æ ¼éœ€è¦æ”¯æŒåˆ†é¡µã€‚B2z6448PQSc3P5d8RibCpEJZ9ZaX16ayHXniF5A52nY=

æˆ‘ä»¬å¯ä»¥æ‹†åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤æ¥å¼€å‘ï¼š

#### 1ã€è¡¨æ ¼

1ï¼‰åˆ©ç”¨ [Ant Design çš„è¡¨æ ¼ç»„ä»¶](https://antdv.com/components/table-cn#components-table-demo-basic)ï¼Œæ‰¾åˆ°éœ€è¦çš„ç»„ä»¶è¿›è¡Œå¤åˆ¶ï¼Œå…ˆå±•ç¤ºå…¨éƒ¨ç”¨æˆ·ä¿¡æ¯ã€‚uPqbd3DiPd3iSPyF1TJ20nEUpYukqZektmm49mRYrTY=

![](https://pic.code-nav.cn/course_picture/1612112932991139842/TciscLvXKqHGXTUl.webp)

2ï¼‰åªéœ€è¦æ ¹æ®è‡ªå·±çš„æ•°æ®è¡¨ï¼Œç¼–å†™ columns è¡¨æ ¼åˆ—ï¼Œå¹¶ä¼ å…¥è·å–åˆ°çš„ data æ•°æ®ï¼Œç»„ä»¶å°±èƒ½è‡ªåŠ¨å¸®æˆ‘ä»¬å±•ç¤ºå‡ºè¡¨æ ¼ï¼Œéå¸¸æ–¹ä¾¿ã€‚

å®šä¹‰è¡¨æ ¼åˆ—ï¼štitleæ˜¯æ˜¾ç¤ºåœ¨å‰ç«¯é¡µé¢çš„æ–‡å­—ï¼ŒdataIndexæ˜¯ä»åç«¯å–è¿‡æ¥å­—æ®µçš„åç§°

```csharp
const columns = [
  {
    title: 'id',
    dataIndex: 'id',
  },
  {
    title: 'è´¦å·',
    dataIndex: 'userAccount',
  },
  {
    title: 'ç”¨æˆ·å',
    dataIndex: 'userName',
  },
  {
    title: 'å¤´åƒ',
    dataIndex: 'userAvatar',
  },
  {
    title: 'ç®€ä»‹',
    dataIndex: 'userProfile',
  },
  {
    title: 'ç”¨æˆ·è§’è‰²',
    dataIndex: 'userRole',
  },
  {
    title: 'åˆ›å»ºæ—¶é—´',
    dataIndex: 'createTime',
  },
  {
    title: 'æ›´æ–°æ—¶é—´',
    dataIndex: 'updateTime',
  },
  {
    title: 'æ“ä½œ',
    key: 'action',
  },
]
```

3ï¼‰ä»åç«¯è·å–æ•°æ®ï¼š

```kotlin
// æ•°æ®
const dataList = ref([])
const total = ref(0)

// æœç´¢æ¡ä»¶
const searchParams = reactive<API.UserQueryRequest>({
  current: 1,
  pageSize: 10,
})

// è·å–æ•°æ®
const fetchData = async () => {
  const res = await listUserVoByPageUsingPost({
    ...searchParams
  })
  if (res.data.data) {
    dataList.value = res.data.data.records ?? []
    total.value = res.data.data.total ?? 0
  } else {
    message.error('è·å–æ•°æ®å¤±è´¥ï¼Œ' + res.data.message)
  }
}

// é¡µé¢åŠ è½½æ—¶è¯·æ±‚ä¸€æ¬¡
onMounted(() => {
  fetchData()
})
```

æ³¨æ„ï¼Œä¸Šè¿°ä»£ç ä¸­ï¼Œä½¿ç”¨ onMounted åŒ…è£¹è·å–æ•°æ®çš„å‡½æ•°ï¼Œå¯ä»¥ä½¿å¾—åœ¨é¡µé¢åŠ è½½æ—¶ä»…å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œé¿å…é‡å¤è·å–ã€‚

è¿è¡Œï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®è¢«æ­£å¸¸åŠ è½½ï¼Œä½†æ˜¯æ˜¾ç„¶å±•ç¤ºæ•ˆæœå¹¶ä¸å¥½ã€‚

4ï¼‰å¯¹äºå›¾ç‰‡ã€ç”¨æˆ·è§’è‰²ã€åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ä¹‹ç±»çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰æ›´å¥½çš„å±•ç¤ºæ–¹å¼ã€‚9JcB9KvGktsJeCekY//R96Nlv+uCpT8TeUU7sYgObzE=

è¡¨æ ¼ç»„ä»¶æ”¯æŒæˆ‘ä»¬ä½¿ç”¨ Vue çš„æ’æ§½è‡ªå®šä¹‰åˆ—çš„å±•ç¤ºï¼Œå‚è€ƒ Demo æœ‰æ ·å­¦æ ·ä¿®æ”¹å³å¯ã€‚

```php-template
<template #bodyCell="{ column, record }">
  <template v-if="column.dataIndex === 'userAvatar'">
    <a-image :src="record.userAvatar" :width="120" />
  </template>
  <template v-else-if="column.dataIndex === 'userRole'">
    <div v-if="record.userRole === 'admin'">
      <a-tag color="green">ç®¡ç†å‘˜</a-tag>
    </div>
    <div v-else>
      <a-tag color="blue">æ™®é€šç”¨æˆ·</a-tag>
    </div>
  </template>
  <template v-else-if="column.dataIndex === 'createTime'">
    {{ dayjs(record.createTime).format('YYYY-MM-DD HH:mm:ss') }}
  </template>
  <template v-else-if="column.key === 'action'">
    <a-button danger>åˆ é™¤</a-button>
  </template>
</template>
```

æ•ˆæœå¦‚å›¾ï¼šiIeB8mD2J1oXqiOtY3taWTPWsqKxcGCkYX8MdOVhu+A=

![](https://pic.code-nav.cn/course_picture/1612112932991139842/Wuoms7ujliXOYmEA.webp)

#### 2ã€åˆ†é¡µ

1ï¼‰è¡¨æ ¼ç»„ä»¶ [æ”¯æŒåˆ†é¡µ](https://antdv.com/components/table-cn#pagination)ï¼Œé¦–å…ˆç¼–å†™ä¸€ä¸ªåˆ†é¡µå˜é‡ï¼ŒæŒ‡å®šå½“å‰é¡µå·ã€é¡µé¢å¤§å°ã€æ•°æ®æ€»æ•°ã€å±•ç¤ºæ€»æ•°çš„æ–‡æ¡ˆç­‰å‚æ•°ï¼šTJqV4WBBT2IFrp0o3vsnkggN7VzNkVQlxvcX5lXRIJI=

```javascript
// åˆ†é¡µå‚æ•°
const pagination = computed(() => {
  return {
    current: searchParams.current ?? 1,
    pageSize: searchParams.pageSize ?? 10,
    total: total.value,
    showSizeChanger: true,
    showTotal: (total) => `å…± ${total} æ¡`,
  }
})
```

æ³¨æ„ï¼Œç”±äºè¿™äº›å‚æ•°éƒ½æ˜¯åŠ¨æ€å˜åŒ–çš„ï¼Œéœ€è¦ä½¿ç”¨ Vue çš„ computed è®¡ç®—å±æ€§ï¼Œå¦åˆ™å½“ searchParams æ”¹å˜æ—¶ï¼Œåˆ†é¡µå‚æ•°å¹¶ä¸ä¼šæ›´æ–°ã€‚

2ï¼‰ç¼–å†™ doTableChange å‡½æ•°ï¼Œå½“ç”¨æˆ·åˆ‡æ¢é¡µå·å’Œé¡µé¢å¤§å°æ—¶ï¼Œéœ€è¦æ›´æ–° searchParams æœç´¢æ¡ä»¶çš„å€¼ï¼Œå¹¶è§¦å‘æœç´¢ï¼šsV0XXF40kQah+NcVxFP1y4nQNGtV/XyQvOt/FJKWUoA=

```typescript
// è¡¨æ ¼å˜åŒ–å¤„ç†
const doTableChange = (page: any) => {
  searchParams.current = page.current
  searchParams.pageSize = page.pageSize
  fetchData()
}
```

3ï¼‰ç»™è¡¨æ ¼ç»„ä»¶ç»‘å®šåˆ†é¡µå‚æ•°å’Œè¡¨æ ¼åˆ‡æ¢äº‹ä»¶ï¼š

```ruby
<a-table
  :columns="columns"
  :data-source="dataList"
  :pagination="pagination"
  @change="doTableChange"
>
```

æ•ˆæœå¦‚å›¾ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/oVbPXPeNBmWNh9vM.webp)

#### 3ã€æœç´¢

åˆ©ç”¨ [Ant Design çš„æœç´¢ç»„ä»¶](https://antdv.com/components/input-cn#components-input-demo-search-input)ï¼Œå®ç°å¯¹æ•°æ®çš„æœç´¢ã€‚

1ï¼‰å…¶å®æœç´¢æœ¬è´¨ä¸Šå°±æ˜¯è®©ç”¨æˆ·å¡«å†™æœç´¢æ¡ä»¶è¡¨å•ï¼Œæ­¤å¤„æˆ‘ä»¬éœ€è¦æ ¹æ®è´¦å·å’Œç”¨æˆ·æ˜µç§°æœç´¢ï¼Œç¼–å†™è¡¨å•ä»£ç ï¼š

```php-template
<a-form layout="inline" :model="searchParams" @finish="doSearch">
  <a-form-item label="è´¦å·">
    <a-input v-model:value="searchParams.userAccount" placeholder="è¾“å…¥è´¦å·" />
  </a-form-item>
  <a-form-item label="ç”¨æˆ·å">
    <a-input v-model:value="searchParams.userName" placeholder="è¾“å…¥ç”¨æˆ·å" />
  </a-form-item>
  <a-form-item>
    <a-button type="primary" html-type="submit">æœç´¢</a-button>
  </a-form-item>
</a-form>
```

ä½¿ç”¨ searchParams æ¥å—ç”¨æˆ·çš„è¾“å…¥ï¼Œç›¸å½“äºæ‰€æœ‰çš„æœç´¢æ¡ä»¶å…¨éƒ¨å­˜åˆ°äº† seachParams ä¸­ï¼Œä¾¿äºç»Ÿä¸€ç»´æŠ¤ã€‚

2ï¼‰ç‚¹å‡»æœç´¢æŒ‰é’®æ—¶ä¼šè§¦å‘è¡¨å•æäº¤ï¼Œè¡¨å•æäº¤æ—¶éœ€è¦å°†é¡µå·é‡ç½®ä¸º 1ï¼Œå¹¶è·å–æ•°æ®ã€‚ç¼–å†™å¯¹åº”çš„å‡½æ•°ï¼š

```javascript
// è·å–æ•°æ®
const doSearch = () => {
  // é‡ç½®é¡µç 
  searchParams.current = 1
  fetchData()
}
```

æ•ˆæœå¦‚å›¾ï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/EkM10lqzzv98Bi9i.webp)

#### 4ã€æ“ä½œ

æ¯”å¦‚å¼€å‘åˆ é™¤åŠŸèƒ½ï¼Œå…ˆç¼–å†™ç‚¹å‡»åˆ é™¤æŒ‰é’®åçš„å¤„ç†å‡½æ•°ï¼š

```typescript
// åˆ é™¤æ•°æ®
const doDelete = async (id: string) => {
  if (!id) {
    return
  }
  const res = await deleteUserUsingPost({ id })
  if (res.data.code === 0) {
    message.success('åˆ é™¤æˆåŠŸ')
    // åˆ·æ–°æ•°æ®
    fetchData()
  } else {
    message.error('åˆ é™¤å¤±è´¥')
  }
}
```

ç„¶åç»™åˆ é™¤æŒ‰é’®ç»‘å®šäº‹ä»¶ï¼šuPqbd3DiPd3iSPyF1TJ20nEUpYukqZektmm49mRYrTY=

```css
<a-button danger @click="doDelete(record.id)">åˆ é™¤</a-button>
```

### ç”¨æˆ·æƒé™æ§åˆ¶

è™½ç„¶åç«¯è·å–ç”¨æˆ·åˆ—è¡¨çš„æ¥å£åšäº†æƒé™æ ¡éªŒï¼Œé˜²æ­¢éç®¡ç†å‘˜ç”¨æˆ·è·å–åˆ°ã€‚ä½†ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¿è¯ç³»ç»Ÿå®‰å…¨å’Œæå‡ç”¨æˆ·ä½“éªŒï¼Œå‰ç«¯ä¹Ÿéœ€è¦å¯¹æƒé™è¿›è¡Œæ§åˆ¶ã€‚9JcB9KvGktsJeCekY//R96Nlv+uCpT8TeUU7sYgObzE=

æœ‰ 2 ç§å®ç°æ–¹å¼ï¼šå•é¡µé¢æ§åˆ¶æƒé™ï¼Œæˆ–è€…å…¨å±€æ§åˆ¶æƒé™ã€‚

æ€è·¯éƒ½æ˜¯ä¸€è‡´çš„ï¼Œåœ¨è¿›å…¥æŸä¸ªé¡µé¢æ—¶åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å…·æœ‰è¯¥é¡µé¢çš„æƒé™ï¼Œæ— éæ˜¯æŠŠæƒé™æ ¡éªŒç›¸å…³çš„ä»£ç å†™åœ¨å•ä¸ªé¡µé¢å†…ï¼Œè¿˜æ˜¯å†™åˆ°ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ä¸­ç½¢äº†ã€‚

\*\*å»ºè®®ç¼–å†™ç‹¬ç«‹çš„å…¨å±€æƒé™æ§åˆ¶æ–‡ä»¶ã€‚\*\*å¯ä»¥åˆ©ç”¨ Vue Router çš„è·¯ç”±å®ˆå«å®ç°ï¼Œæ¯æ¬¡åˆ‡æ¢å¹¶è¿›å…¥é¡µé¢å‰ï¼Œéƒ½ä¼šæ£€æŸ¥ä¸€ä¸‹å½“å‰ç”¨æˆ·æ˜¯å¦å…·æœ‰ç‰¹å®šé¡µé¢çš„æƒé™ã€‚B2z6448PQSc3P5d8RibCpEJZ9ZaX16ayHXniF5A52nY=

åœ¨ src ä¸‹ç¼–å†™ access.ts æƒé™æ ¡éªŒæ–‡ä»¶ï¼Œå¯ä»¥è‡ªå·±å®šä¹‰é€»è¾‘ï¼Œæ¯”å¦‚ç”¨é¡µé¢å‰ç¼€æ¥ç»Ÿä¸€åˆ¤æ–­ï¼š

```javascript
import { useLoginUserStore } from '@/stores/useLoginUserStore'
import { message } from 'ant-design-vue'
import router from '@/router'

// æ˜¯å¦ä¸ºé¦–æ¬¡è·å–ç™»å½•ç”¨æˆ·
let firstFetchLoginUser = true;

/**
 * å…¨å±€æƒé™æ ¡éªŒ
 */
router.beforeEach(async (to, from, next) => {
  const loginUserStore = useLoginUserStore()
  let loginUser = loginUserStore.loginUser
  // ç¡®ä¿é¡µé¢åˆ·æ–°ï¼Œé¦–æ¬¡åŠ è½½æ—¶ï¼Œèƒ½å¤Ÿç­‰åç«¯è¿”å›ç”¨æˆ·ä¿¡æ¯åå†æ ¡éªŒæƒé™
  if (firstFetchLoginUser) {
    await loginUserStore.fetchLoginUser()
    loginUser = loginUserStore.loginUser
    firstFetchLoginUser = false;
  }
  const toUrl = to.fullPath
  if (toUrl.startsWith('/admin')) {
    if (!loginUser || loginUser.userRole !== 'admin') {
      message.error('æ²¡æœ‰æƒé™')
      next(`/user/login?redirect=${to.fullPath}`)
      return
    }
  }
  next()
})
```

æ³¨æ„ï¼Œä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸ºäº†ç¡®ä¿é¡µé¢åˆ·æ–°æ—¶ï¼Œä»åç«¯æ‹¿åˆ°ç”¨æˆ·ä¿¡æ¯åå†è¿›è¡Œæƒé™æ ¡éªŒï¼Œä½¿ç”¨ await ç­‰å¾…åç«¯æ¥å£è¿”å›ï¼Œå¹¶é‡æ–°èµ‹å€¼ç»™ loginUserã€‚åŒæ—¶ï¼Œä¸ºäº†é˜²æ­¢æ¯æ¬¡åˆ‡æ¢è·¯ç”±éƒ½ä»è¿œç¨‹è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå®šä¹‰äº† firstFetchLoginUser å˜é‡ï¼Œç”¨äºæ§åˆ¶åœ¨åˆ·æ–°é¡µé¢ååªä¼šè¯·æ±‚åç«¯ä¸€æ¬¡ã€‚xo0dnOlnBf7Ws27/qGm2TPReUJyIxD/DuwJOjlvKUe0=

ğŸ’¡ ç”±äºåœ¨ access.ts ä¸­å·²ç»è·å–åˆ°äº†ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼Œå¯ä»¥ç§»é™¤æ‰ä¹‹å‰åœ¨ App.vue ä¸­è·å–ç™»å½•ç”¨æˆ·ä¿¡æ¯çš„é€»è¾‘ï¼Œé¿å…é‡å¤è¯·æ±‚ã€‚

åœ¨ main.tsï¼ˆå…¨å±€å…¥å£æ–‡ä»¶ï¼‰ä¸­å¼•å…¥ï¼š

```go
import '@/access'
```

ç”¨ä¸€ä¸ªæœªç™»å½•çš„ç”¨æˆ·æ¥æµ‹è¯•ï¼Œå°è¯•è®¿é—®ç”¨æˆ·ç®¡ç†é¡µé¢ï¼Œä¼šæŠ¥æƒé™é”™è¯¯å¹¶è·³è½¬åˆ°ç™»å½•é¡µï¼š

![](https://pic.code-nav.cn/course_picture/1612112932991139842/5oBSTqJaYfaCRIoq.webp)

è™½ç„¶å·²ç»æ»¡è¶³äº†éœ€æ±‚ï¼Œä½†æ˜¯å¦‚æœç”¨æˆ·ä¸æ˜¯ç®¡ç†å‘˜ï¼Œå…¶å®ä¹Ÿä¸åº”è¯¥çœ‹åˆ° â€œç”¨æˆ·ç®¡ç†â€ èœå•ã€‚å› æ­¤æˆ‘ä»¬è¿˜è¦ä¿®æ”¹ GlobalHeader èœå•é¡¹é…ç½®ï¼Œæ ¹æ®æƒé™å†³å®šæ˜¯å¦å±•ç¤ºæŸäº›èœå•é¡¹ã€‚9JcB9KvGktsJeCekY//R96Nlv+uCpT8TeUU7sYgObzE=

ç¼–å†™ä¸€ä¸ªè¿‡æ»¤èœå•é¡¹çš„å‡½æ•°ï¼š

```javascript
// èœå•åˆ—è¡¨
const originItems = [
  {
    key: '/',
    icon: () => h(HomeOutlined),
    label: 'ä¸»é¡µ',
    title: 'ä¸»é¡µ',
  },
  {
    key: '/admin/userManage',
    label: 'ç”¨æˆ·ç®¡ç†',
    title: 'ç”¨æˆ·ç®¡ç†',
  },
  {
    key: 'others',
    label: h('a', { href: 'https://www.codefather.cn', target: '_blank' }, 'ç¼–ç¨‹å¯¼èˆª'),
    title: 'ç¼–ç¨‹å¯¼èˆª',
  },
]

// è¿‡æ»¤èœå•é¡¹
const filterMenus = (menus = [] as MenuProps['items']) => {
  return menus?.filter((menu) => {
    if (menu.key.startsWith('/admin')) {
      const loginUser = loginUserStore.loginUser
      if (!loginUser || loginUser.userRole !== "admin") {
        return false
      }
    }
    return true
  })
}

// å±•ç¤ºåœ¨èœå•çš„è·¯ç”±æ•°ç»„
const items = computed<MenuProps['items']>(() => filterMenus(originItems))
```

æµ‹è¯•æ•ˆæœï¼Œæœªç™»å½•æ—¶ä¸ä¼šçœ‹åˆ° â€œç”¨æˆ·ç®¡ç†â€ èœå•ï¼šTJqV4WBBT2IFrp0o3vsnkggN7VzNkVQlxvcX5lXRIJI=

![](https://pic.code-nav.cn/course_picture/1612112932991139842/l22vo6kvBVO2mL0D.webp)

### æ‰©å±•

#### 1ã€ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯

1ï¼‰ç›®å‰çš„ç”¨æˆ·ç®¡ç†é¡µé¢è¿˜ä¸æ”¯æŒç¼–è¾‘åŠŸèƒ½ï¼Œå‰ç«¯å¯ä»¥åˆ©ç”¨ [ç»„ä»¶åº“æ–‡æ¡£](https://antdv.com/components/table-cn#components-table-demo-edit-row) çš„ç¼–è¾‘è¡Œèƒ½åŠ›å¿«é€Ÿå®Œæˆã€‚

2ï¼‰ç›®å‰ç”¨æˆ·æ— æ³•ç¼–è¾‘ä¸ªäººçš„ä¿¡æ¯ï¼Œå¯ä»¥åœ¨å³ä¸Šè§’å¢åŠ  â€œä¸ªäººä¸­å¿ƒ / ä¸ªäººè®¾ç½®â€ï¼Œç‚¹å‡»åè¿›å…¥ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯çš„è¡¨å•ã€‚

#### 2ã€å…¨å±€æƒé™ç®¡ç†

åœ¨æœ¬èŠ‚ â€œç”¨æˆ·æƒé™æ§åˆ¶â€ éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ç§è¾ƒä¸ºç®€å•çš„æ–¹å¼å®ç°ï¼Œä½†æ˜¯ï¼Œåç»­è¡¥å……é¡µé¢å’Œæƒé™æ ¡éªŒé€»è¾‘æ—¶ï¼Œæˆ‘ä»¬è¦åŒæ—¶ä¿®æ”¹æƒé™ç®¡ç†æ–‡ä»¶å’Œå¯¼èˆªæ æ–‡ä»¶ï¼Œç›¸å½“äºç»´æŠ¤äº† 2 ä¸ªæ–‡ä»¶ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„åŠæ³•å‘¢ï¼Ÿ

éœ€æ±‚ï¼šèƒ½å¤Ÿé€šè¿‡ç»´æŠ¤ **ä¸€ä¸ªé…ç½®æ–‡ä»¶**ï¼Œçµæ´»é…ç½®æ¯ä¸ªé¡µé¢æ‰€éœ€è¦çš„ç”¨æˆ·æƒé™ï¼Œç”±å…¨å±€æƒé™ç®¡ç†ç³»ç»Ÿè‡ªåŠ¨æ ¡éªŒå’Œæ‹¦æˆªï¼Œè€Œä¸éœ€è¦åœ¨æ¯ä¸ªé¡µé¢ä¸­ç¼–å†™æƒé™æ ¡éªŒä»£ç ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚æ­¤å¤–ï¼Œè¿˜èƒ½æ ¹æ®è¯¥é…ç½®æ–‡ä»¶è‡ªåŠ¨éšè—æ²¡æƒé™çš„èœå•é¡¹çš„å±•ç¤ºã€‚

å®ç°æ–¹æ¡ˆï¼š9JcB9KvGktsJeCekY//R96Nlv+uCpT8TeUU7sYgObzE=

1.  åœ¨è·¯ç”±é…ç½®æ–‡ä»¶ï¼Œåˆ©ç”¨ Vue Router çš„ meta é™„åŠ å‚æ•°ï¼Œå®šä¹‰æŸä¸ªè·¯ç”±çš„è®¿é—®æƒé™
2.  ä½¿ç”¨å…¨å±€è·¯ç”±ç›‘å¬å™¨ï¼Œæ¯æ¬¡è®¿é—®é¡µé¢æ—¶ï¼Œæ ¹æ®ç”¨æˆ·è¦è®¿é—®é¡µé¢çš„è·¯ç”±æƒé™ä¿¡æ¯ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰å¯¹åº”çš„è®¿é—®æƒé™ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„æ‹¦æˆªå¤„ç†ã€‚

éœ€è¦å…ˆè‡ªè¡Œæ–°å»º NoAuth æ— æƒé™é¡µé¢ï¼Œå†…å®¹éšä¾¿å†™ï¼Œæ¯”å¦‚æ˜¾ç¤º â€œä½ æ²¡æœ‰æƒé™â€ã€‚

æ–°å»º access ç›®å½•ï¼Œæ‰€æœ‰æƒé™ç®¡ç†ç›¸å…³çš„ä»£ç éƒ½æ”¾åœ¨è¯¥ç›®å½•ä¸‹ï¼Œæ¨¡å—åŒ–ã€‚åªè¦ä¸å¼•å…¥ï¼Œå°±ä¸ä¼šç”Ÿæ•ˆã€‚E2AG5YeWw8LgKsKYXs9Vrz+8AgTqaJUf5eaOZTC+BFg=

1ï¼‰å®šä¹‰æƒé™æšä¸¾æ–‡ä»¶ accessEnum.tsï¼š

```cpp
/**
 * æƒé™å®šä¹‰
 */
const ACCESS_ENUM = {
  NOT_LOGIN: "notLogin",
  USER: "user",
  ADMIN: "admin",
};

export default ACCESS_ENUM;
```

2ï¼‰ä¿®æ”¹è·¯ç”±é…ç½®æ–‡ä»¶ï¼Œåœ¨ meta ä¸­è¡¥å……éœ€è¦çš„æƒé™ï¼šB2z6448PQSc3P5d8RibCpEJZ9ZaX16ayHXniF5A52nY=

```css
{
  path: '/admin/userManage',
  name: 'adminUserManage',
  component: UserManagePage,
  meta: {
    access: ACCESS_ENUM.ADMIN,
  },
},
```

3ï¼‰ç¼–å†™é€šç”¨çš„æƒé™æ ¡éªŒæ–¹æ³•ã€‚

Qï¼šä¸ºä»€ä¹ˆï¼ŸsV0XXF40kQah+NcVxFP1y4nQNGtV/XyQvOt/FJKWUoA=

Aï¼šå› ä¸ºèœå•ç»„ä»¶ä¸­è¦åˆ¤æ–­æƒé™æ¥è¿‡æ»¤å±•ç¤ºçš„èœå•é¡¹ã€æƒé™æ‹¦æˆªä¹Ÿè¦ç”¨åˆ°æƒé™åˆ¤æ–­åŠŸèƒ½ï¼Œæ‰€ä»¥æŠ½ç¦»æˆå…¬å…±æ¨¡å—ã€‚

checkAccess.ts æ–‡ä»¶ï¼š

```typescript
import ACCESS_ENUM from "@/access/accessEnum";

/**
 * æ£€æŸ¥æƒé™ï¼ˆåˆ¤æ–­å½“å‰ç™»å½•ç”¨æˆ·æ˜¯å¦å…·æœ‰æŸä¸ªæƒé™ï¼‰
 * @param loginUser å½“å‰ç™»å½•ç”¨æˆ·
 * @param needAccess éœ€è¦æœ‰çš„æƒé™
 * @return boolean æœ‰æ— æƒé™
 */
const checkAccess = (loginUser: any, needAccess = ACCESS_ENUM.NOT_LOGIN) => {
  // è·å–å½“å‰ç™»å½•ç”¨æˆ·å…·æœ‰çš„æƒé™ï¼ˆå¦‚æœæ²¡æœ‰ loginUserï¼Œåˆ™è¡¨ç¤ºæœªç™»å½•ï¼‰
  const loginUserAccess = loginUser?.userRole ?? ACCESS_ENUM.NOT_LOGIN;
  if (needAccess === ACCESS_ENUM.NOT_LOGIN) {
    return true;
  }
  // å¦‚æœç”¨æˆ·ç™»å½•æ‰èƒ½è®¿é—®
  if (needAccess === ACCESS_ENUM.USER) {
    // å¦‚æœç”¨æˆ·æ²¡ç™»å½•ï¼Œé‚£ä¹ˆè¡¨ç¤ºæ— æƒé™
    if (loginUserAccess === ACCESS_ENUM.NOT_LOGIN) {
      return false;
    }
  }
  // å¦‚æœéœ€è¦ç®¡ç†å‘˜æƒé™
  if (needAccess === ACCESS_ENUM.ADMIN) {
    // å¦‚æœä¸ä¸ºç®¡ç†å‘˜ï¼Œè¡¨ç¤ºæ— æƒé™
    if (loginUserAccess !== ACCESS_ENUM.ADMIN) {
      return false;
    }
  }
  return true;
};

export default checkAccess;
```

4ï¼‰ç¼–å†™å…¨å±€æƒé™æ ¡éªŒæ ¸å¿ƒæ–‡ä»¶ `access/index.ts`ã€‚

é€»è¾‘å¦‚ä¸‹ï¼š

1.  é¦–å…ˆåˆ¤æ–­é¡µé¢æ˜¯å¦éœ€è¦ç™»å½•æƒé™ï¼Œå¦‚æœä¸éœ€è¦ï¼Œç›´æ¥æ”¾è¡Œã€‚
2.  å¦‚æœé¡µé¢éœ€è¦ç™»å½•æƒé™
    1.  å¦‚æœç”¨æˆ·æœªç™»å½•ï¼Œåˆ™è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚
    2.  å¦‚æœå·²ç™»å½•ï¼Œåˆ¤æ–­ç™»å½•ç”¨æˆ·çš„æƒé™æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œå¦åˆ™è·³è½¬åˆ° 401 æ— æƒé™é¡µé¢ã€‚

å®ç°ä»£ç å¦‚ä¸‹ï¼š

```typescript
import router from '@/router'
import { useLoginUserStore } from '@/stores/useLoginUserStore'
import ACCESS_ENUM from './accessEnum'
import checkAccess from './checkAccess'

router.beforeEach(async (to, from, next) => {
  const loginUserStore = useLoginUserStore()
  let loginUser = loginUserStore.loginUser
  console.log('ç™»é™†ç”¨æˆ·ä¿¡æ¯', loginUser)
  const needAccess = (to.meta?.access as string) ?? ACCESS_ENUM.NOT_LOGIN
  // è¦è·³è½¬çš„é¡µé¢å¿…é¡»è¦ç™»é™†
  if (needAccess !== ACCESS_ENUM.NOT_LOGIN) {
    // å¦‚æœæ²¡ç™»é™†ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢
    if (!loginUser || !loginUser.userRole || loginUser.userRole === ACCESS_ENUM.NOT_LOGIN) {
      next(`/user/login?redirect=${to.fullPath}`)
      return
    }
    // å¦‚æœå·²ç»ç™»é™†äº†ï¼Œä½†æ˜¯æƒé™ä¸è¶³ï¼Œé‚£ä¹ˆè·³è½¬åˆ°æ— æƒé™é¡µé¢
    if (!checkAccess(loginUser, needAccess)) {
      next('/noAuth')
      return
    }
  }
  next()
})
```

æ³¨æ„ï¼Œå¿…é¡»ä¿è¯ pinia åˆå§‹åŒ–åœ¨è¿™æ®µä»£ç æ‰§è¡Œå‰ï¼Œæ‰€ä»¥éœ€è¦å°† `useLoginUserStore()` å‡½æ•°æ”¾åˆ° `router.beforeEach` å‚æ•°é‡Œã€‚TJqV4WBBT2IFrp0o3vsnkggN7VzNkVQlxvcX5lXRIJI=

å‚è€ƒï¼š[https://pinia.vuejs.org/core-concepts/outside-component-usage.html](https://pinia.vuejs.org/core-concepts/outside-component-usage.html)

åœ¨ main.ts ä¸­å¼•å…¥ï¼Œå³å¯ç”Ÿæ•ˆæƒé™æ ¡éªŒï¼š

```cpp
import "@/access";
```

5ï¼‰æ”¯æŒå…¨å±€è‡ªåŠ¨ç™»å½•ã€‚å¦‚æœæ˜¯ \*\*é¦–æ¬¡ \*\*è¿›å…¥é¡µé¢ï¼ŒçŠ¶æ€ä¸ºæœªç™»é™†ï¼Œåˆ™è‡ªåŠ¨ç™»å½•ã€‚

å¦‚ä½•åŒºåˆ«æ˜¯å¦ä¸ºé¦–æ¬¡è¿›å…¥é¡µé¢ï¼ˆè¿˜æ²¡å°è¯•è¿‡è·å–ç™»å½•ç”¨æˆ·ï¼‰å‘¢ï¼Ÿ

é»˜è®¤çš„ loginUser æ˜¯æ²¡æœ‰ userRole çš„ï¼Œåªè¦è·å–è¿‡ï¼Œå“ªæ€•æœªç™»å½•ï¼Œä¹Ÿå¯ä»¥ç»™è®¾ç½®ä¸€ä¸ª userRole ä¸º "notLogin"ã€‚uPqbd3DiPd3iSPyF1TJ20nEUpYukqZektmm49mRYrTY=

åœ¨ `access/index.ts` å¼€å¤´è¡¥å……è‡ªåŠ¨ç™»å½•é€»è¾‘

```csharp
// // å¦‚æœä¹‹å‰æ²¡ç™»é™†è¿‡ï¼Œè‡ªåŠ¨ç™»å½•
if (!loginUser || !loginUser.userRole) {
  // åŠ  await æ˜¯ä¸ºäº†ç­‰ç”¨æˆ·ç™»å½•æˆåŠŸä¹‹åï¼Œå†æ‰§è¡Œåç»­çš„ä»£ç 
  await loginUserStore.fetchLoginUser();
  loginUser = loginUserStore.loginUser;
}
```

ä¹‹åè®°å¾—ç§»é™¤ App.vue ä¸­è·å–ç™»å½•ä¿¡æ¯çš„è°ƒç”¨ã€‚B2z6448PQSc3P5d8RibCpEJZ9ZaX16ayHXniF5A52nY=

6ï¼‰æ ¹æ®æƒé™æ§åˆ¶èœå•æ˜¾éšã€‚

éœ€æ±‚ï¼šåªæœ‰å…·æœ‰æƒé™çš„èœå•ï¼Œæ‰å¯¹ç”¨æˆ·å¯è§

åŸç†ï¼šxo0dnOlnBf7Ws27/qGm2TPReUJyIxD/DuwJOjlvKUe0=

1.  éå†åŸèœå•é¡¹åˆ—è¡¨ï¼Œé’ˆå¯¹èœå• key å¯¹åº”çš„ path è·¯å¾„ï¼Œæ‰¾åˆ°è·¯ç”±ä¸­å¯¹åº”çš„ meta æƒé™é…ç½®ã€‚åªè¦åˆ¤æ–­ç”¨æˆ·æ²¡æœ‰è¿™ä¸ªæƒé™ï¼Œå°±ç›´æ¥è¿‡æ»¤æ‰ã€‚
2.  è¿˜å¯ä»¥é€šè¿‡åœ¨è·¯ç”±é…ç½®çš„ meta ä¸­æ·»åŠ  hideInMenuï¼Œçµæ´»æ§åˆ¶èœå•çš„æ˜¾éšã€‚

ä¿®æ”¹ GlobalHeader å…¨å±€å¯¼èˆªæ ï¼ˆé€šç”¨èœå•ï¼‰ç»„ä»¶ï¼Œè¡¥å……æ ¹æ®æƒé™æ¥è¿‡æ»¤èœå•çš„é€»è¾‘ï¼Œå¯è‡ªè¡Œå®ç°ã€‚

```typescript
// è¿‡æ»¤èœå•é¡¹
const items = menus.filter((menu) => {
  // todo éœ€è¦è‡ªå·±å®ç° menu åˆ°è·¯ç”± item çš„è½¬åŒ–
  const item = menuToRouteItem(menu);
  if (item.meta?.hideInMenu) {
    return false;
  }
  // æ ¹æ®æƒé™è¿‡æ»¤èœå•ï¼Œæœ‰æƒé™åˆ™è¿”å› trueï¼Œåˆ™ä¿ç•™è¯¥èœå•
  return checkAccess(loginUserStore.loginUser, item.meta?.access as string);
});
```

ChdipREN0jrjiXgJ/YkPo5ufCLwmKJhcbf8H+qMVE48=